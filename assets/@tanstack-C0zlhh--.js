var Wt=(r,t,e)=>{if(!t.has(r))throw TypeError("Cannot "+e)};var i=(r,t,e)=>(Wt(r,t,"read from private field"),e?e.call(r):t.get(r)),u=(r,t,e)=>{if(t.has(r))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(r):t.set(r,e)},h=(r,t,e,s)=>(Wt(r,t,"write to private field"),s?s.call(r,e):t.set(r,e),e);var Gt=(r,t,e,s)=>({set _(n){h(r,t,n,e)},get _(){return i(r,t,s)}}),f=(r,t,e)=>(Wt(r,t,"access private method"),e);var Mt=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Rt=typeof window>"u"||"Deno"in globalThis;function L(){}function ke(r,t){return typeof r=="function"?r(t):r}function Jt(r){return typeof r=="number"&&r>=0&&r!==1/0}function Qe(r,t){return Math.max(r+(t||0)-Date.now(),0)}function le(r,t){const{type:e="all",exact:s,fetchStatus:n,predicate:a,queryKey:c,stale:d}=r;if(c){if(s){if(t.queryHash!==ue(c,t.options))return!1}else if(!Dt(t.queryKey,c))return!1}if(e!=="all"){const w=t.isActive();if(e==="active"&&!w||e==="inactive"&&w)return!1}return!(typeof d=="boolean"&&t.isStale()!==d||n&&n!==t.state.fetchStatus||a&&!a(t))}function de(r,t){const{exact:e,status:s,predicate:n,mutationKey:a}=r;if(a){if(!t.options.mutationKey)return!1;if(e){if(lt(t.options.mutationKey)!==lt(a))return!1}else if(!Dt(t.options.mutationKey,a))return!1}return!(s&&t.state.status!==s||n&&!n(t))}function ue(r,t){return((t==null?void 0:t.queryKeyHashFn)||lt)(r)}function lt(r){return JSON.stringify(r,(t,e)=>Xt(e)?Object.keys(e).sort().reduce((s,n)=>(s[n]=e[n],s),{}):e)}function Dt(r,t){return r===t?!0:typeof r!=typeof t?!1:r&&t&&typeof r=="object"&&typeof t=="object"?!Object.keys(t).some(e=>!Dt(r[e],t[e])):!1}function De(r,t){if(r===t)return r;const e=fe(r)&&fe(t);if(e||Xt(r)&&Xt(t)){const s=e?r:Object.keys(r),n=s.length,a=e?t:Object.keys(t),c=a.length,d=e?[]:{};let w=0;for(let g=0;g<c;g++){const p=e?g:a[g];(!e&&s.includes(p)||e)&&r[p]===void 0&&t[p]===void 0?(d[p]=void 0,w++):(d[p]=De(r[p],t[p]),d[p]===r[p]&&r[p]!==void 0&&w++)}return n===c&&w===n?r:d}return t}function _t(r,t){if(!t||Object.keys(r).length!==Object.keys(t).length)return!1;for(const e in r)if(r[e]!==t[e])return!1;return!0}function fe(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function Xt(r){if(!ye(r))return!1;const t=r.constructor;if(t===void 0)return!0;const e=t.prototype;return!(!ye(e)||!e.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function ye(r){return Object.prototype.toString.call(r)==="[object Object]"}function He(r){return new Promise(t=>{setTimeout(t,r)})}function Yt(r,t,e){return typeof e.structuralSharing=="function"?e.structuralSharing(r,t):e.structuralSharing!==!1?De(r,t):t}function Ge(r,t,e=0){const s=[...r,t];return e&&s.length>e?s.slice(1):s}function Ne(r,t,e=0){const s=[t,...r];return e&&s.length>e?s.slice(0,-1):s}var Ee=Symbol(),Ae=(r,t)=>!r.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!r.queryFn||r.queryFn===Ee?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn,it,V,dt,be,Be=(be=class extends Mt{constructor(){super();u(this,it,void 0);u(this,V,void 0);u(this,dt,void 0);h(this,dt,t=>{if(!Rt&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}})}onSubscribe(){i(this,V)||this.setEventListener(i(this,dt))}onUnsubscribe(){var t;this.hasListeners()||((t=i(this,V))==null||t.call(this),h(this,V,void 0))}setEventListener(t){var e;h(this,dt,t),(e=i(this,V))==null||e.call(this),h(this,V,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){i(this,it)!==t&&(h(this,it,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){var t;return typeof i(this,it)=="boolean"?i(this,it):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},it=new WeakMap,V=new WeakMap,dt=new WeakMap,be),oe=new Be,ft,J,yt,ge,_e=(ge=class extends Mt{constructor(){super();u(this,ft,!0);u(this,J,void 0);u(this,yt,void 0);h(this,yt,t=>{if(!Rt&&window.addEventListener){const e=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}}})}onSubscribe(){i(this,J)||this.setEventListener(i(this,yt))}onUnsubscribe(){var t;this.hasListeners()||((t=i(this,J))==null||t.call(this),h(this,J,void 0))}setEventListener(t){var e;h(this,yt,t),(e=i(this,J))==null||e.call(this),h(this,J,t(this.setOnline.bind(this)))}setOnline(t){i(this,ft)!==t&&(h(this,ft,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return i(this,ft)}},ft=new WeakMap,J=new WeakMap,yt=new WeakMap,ge),$t=new _e;function $e(r){return Math.min(1e3*2**r,3e4)}function Ue(r){return(r??"online")==="online"?$t.isOnline():!0}var qe=class{constructor(r){this.revert=r==null?void 0:r.revert,this.silent=r==null?void 0:r.silent}};function Vt(r){return r instanceof qe}function Ie(r){let t=!1,e=0,s=!1,n,a,c;const d=new Promise((v,S)=>{a=v,c=S}),w=v=>{var S;s||(C(new qe(v)),(S=r.abort)==null||S.call(r))},g=()=>{t=!0},p=()=>{t=!1},o=()=>oe.isFocused()&&(r.networkMode==="always"||$t.isOnline())&&r.canRun(),l=()=>Ue(r.networkMode)&&r.canRun(),y=v=>{var S;s||(s=!0,(S=r.onSuccess)==null||S.call(r,v),n==null||n(),a(v))},C=v=>{var S;s||(s=!0,(S=r.onError)==null||S.call(r,v),n==null||n(),c(v))},R=()=>new Promise(v=>{var S;n=b=>{(s||o())&&v(b)},(S=r.onPause)==null||S.call(r)}).then(()=>{var v;n=void 0,s||(v=r.onContinue)==null||v.call(r)}),M=()=>{if(s)return;let v;const S=e===0?r.initialPromise:void 0;try{v=S??r.fn()}catch(b){v=Promise.reject(b)}Promise.resolve(v).then(y).catch(b=>{var m;if(s)return;const P=r.retry??(Rt?0:3),Q=r.retryDelay??$e,k=typeof Q=="function"?Q(e,b):Q,_=P===!0||typeof P=="number"&&e<P||typeof P=="function"&&P(e,b);if(t||!_){C(b);return}e++,(m=r.onFail)==null||m.call(r,e,b),He(k).then(()=>o()?void 0:R()).then(()=>{t?C(b):M()})})};return{promise:d,cancel:w,continue:()=>(n==null||n(),d),cancelRetry:g,continueRetry:p,canStart:l,start:()=>(l()?M():R().then(M),d)}}function ze(){let r=[],t=0,e=l=>{l()},s=l=>{l()},n=l=>setTimeout(l,0);const a=l=>{n=l},c=l=>{let y;t++;try{y=l()}finally{t--,t||g()}return y},d=l=>{t?r.push(l):n(()=>{e(l)})},w=l=>(...y)=>{d(()=>{l(...y)})},g=()=>{const l=r;r=[],l.length&&n(()=>{s(()=>{l.forEach(y=>{e(y)})})})};return{batch:c,batchCalls:w,schedule:d,setNotifyFunction:l=>{e=l},setBatchNotifyFunction:l=>{s=l},setScheduler:a}}var D=ze(),rt,Oe,Te=(Oe=class{constructor(){u(this,rt,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Jt(this.gcTime)&&h(this,rt,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(Rt?1/0:5*60*1e3))}clearGcTimeout(){i(this,rt)&&(clearTimeout(i(this,rt)),h(this,rt,void 0))}},rt=new WeakMap,Oe),pt,mt,K,E,Et,nt,x,$,we,We=(we=class extends Te{constructor(t){super();u(this,x);u(this,pt,void 0);u(this,mt,void 0);u(this,K,void 0);u(this,E,void 0);u(this,Et,void 0);u(this,nt,void 0);h(this,nt,!1),h(this,Et,t.defaultOptions),this.setOptions(t.options),this.observers=[],h(this,K,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,h(this,pt,t.state||Ve(this.options)),this.state=i(this,pt),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=i(this,E))==null?void 0:t.promise}setOptions(t){this.options={...i(this,Et),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&i(this,K).remove(this)}setData(t,e){const s=Yt(this.state.data,t,this.options);return f(this,x,$).call(this,{data:s,type:"success",dataUpdatedAt:e==null?void 0:e.updatedAt,manual:e==null?void 0:e.manual}),s}setState(t,e){f(this,x,$).call(this,{type:"setState",state:t,setStateOptions:e})}cancel(t){var s,n;const e=(s=i(this,E))==null?void 0:s.promise;return(n=i(this,E))==null||n.cancel(t),e?e.then(L).catch(L):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(i(this,pt))}isActive(){return this.observers.some(t=>t.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!Qe(this.state.dataUpdatedAt,t)}onFocus(){var e;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(e=i(this,E))==null||e.continue()}onOnline(){var e;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(e=i(this,E))==null||e.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),i(this,K).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(i(this,E)&&(i(this,nt)?i(this,E).cancel({revert:!0}):i(this,E).cancelRetry()),this.scheduleGc()),i(this,K).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||f(this,x,$).call(this,{type:"invalidate"})}fetch(t,e){var w,g,p;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(e!=null&&e.cancelRefetch))this.cancel({silent:!0});else if(i(this,E))return i(this,E).continueRetry(),i(this,E).promise}if(t&&this.setOptions(t),!this.options.queryFn){const o=this.observers.find(l=>l.options.queryFn);o&&this.setOptions(o.options)}const s=new AbortController,n=o=>{Object.defineProperty(o,"signal",{enumerable:!0,get:()=>(h(this,nt,!0),s.signal)})},a=()=>{const o=Ae(this.options,e),l={queryKey:this.queryKey,meta:this.meta};return n(l),h(this,nt,!1),this.options.persister?this.options.persister(o,l,this):o(l)},c={fetchOptions:e,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:a};n(c),(w=this.options.behavior)==null||w.onFetch(c,this),h(this,mt,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((g=c.fetchOptions)==null?void 0:g.meta))&&f(this,x,$).call(this,{type:"fetch",meta:(p=c.fetchOptions)==null?void 0:p.meta});const d=o=>{var l,y,C,R;Vt(o)&&o.silent||f(this,x,$).call(this,{type:"error",error:o}),Vt(o)||((y=(l=i(this,K).config).onError)==null||y.call(l,o,this),(R=(C=i(this,K).config).onSettled)==null||R.call(C,this.state.data,o,this)),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return h(this,E,Ie({initialPromise:e==null?void 0:e.initialPromise,fn:c.fetchFn,abort:s.abort.bind(s),onSuccess:o=>{var l,y,C,R;if(o===void 0){d(new Error(`${this.queryHash} data is undefined`));return}this.setData(o),(y=(l=i(this,K).config).onSuccess)==null||y.call(l,o,this),(R=(C=i(this,K).config).onSettled)==null||R.call(C,o,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:d,onFail:(o,l)=>{f(this,x,$).call(this,{type:"failed",failureCount:o,error:l})},onPause:()=>{f(this,x,$).call(this,{type:"pause"})},onContinue:()=>{f(this,x,$).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0})),i(this,E).start()}},pt=new WeakMap,mt=new WeakMap,K=new WeakMap,E=new WeakMap,Et=new WeakMap,nt=new WeakMap,x=new WeakSet,$=function(t){const e=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...Ke(s.data,this.options),fetchMeta:t.meta??null};case"success":return{...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=t.error;return Vt(n)&&n.revert&&i(this,mt)?{...i(this,mt),fetchStatus:"idle"}:{...s,error:n,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=e(this.state),D.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),i(this,K).notify({query:this,type:"updated",action:t})})},we);function Ke(r,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ue(t.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function Ve(r){const t=typeof r.initialData=="function"?r.initialData():r.initialData,e=t!==void 0,s=e?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}var H,Se,Je=(Se=class extends Mt{constructor(e={}){super();u(this,H,void 0);this.config=e,h(this,H,new Map)}build(e,s,n){const a=s.queryKey,c=s.queryHash??ue(a,s);let d=this.get(c);return d||(d=new We({cache:this,queryKey:a,queryHash:c,options:e.defaultQueryOptions(s),state:n,defaultOptions:e.getQueryDefaults(a)}),this.add(d)),d}add(e){i(this,H).has(e.queryHash)||(i(this,H).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=i(this,H).get(e.queryHash);s&&(e.destroy(),s===e&&i(this,H).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){D.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return i(this,H).get(e)}getAll(){return[...i(this,H).values()]}find(e){const s={exact:!0,...e};return this.getAll().find(n=>le(s,n))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(n=>le(e,n)):s}notify(e){D.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){D.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){D.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},H=new WeakMap,Se),G,A,at,N,W,Fe,Xe=(Fe=class extends Te{constructor(t){super();u(this,N);u(this,G,void 0);u(this,A,void 0);u(this,at,void 0);this.mutationId=t.mutationId,h(this,A,t.mutationCache),h(this,G,[]),this.state=t.state||Le(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){i(this,G).includes(t)||(i(this,G).push(t),this.clearGcTimeout(),i(this,A).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){h(this,G,i(this,G).filter(e=>e!==t)),this.scheduleGc(),i(this,A).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){i(this,G).length||(this.state.status==="pending"?this.scheduleGc():i(this,A).remove(this))}continue(){var t;return((t=i(this,at))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var n,a,c,d,w,g,p,o,l,y,C,R,M,v,S,b,P,Q,k,_;h(this,at,Ie({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(m,j)=>{f(this,N,W).call(this,{type:"failed",failureCount:m,error:j})},onPause:()=>{f(this,N,W).call(this,{type:"pause"})},onContinue:()=>{f(this,N,W).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>i(this,A).canRun(this)}));const e=this.state.status==="pending",s=!i(this,at).canStart();try{if(!e){f(this,N,W).call(this,{type:"pending",variables:t,isPaused:s}),await((a=(n=i(this,A).config).onMutate)==null?void 0:a.call(n,t,this));const j=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t));j!==this.state.context&&f(this,N,W).call(this,{type:"pending",context:j,variables:t,isPaused:s})}const m=await i(this,at).start();return await((g=(w=i(this,A).config).onSuccess)==null?void 0:g.call(w,m,t,this.state.context,this)),await((o=(p=this.options).onSuccess)==null?void 0:o.call(p,m,t,this.state.context)),await((y=(l=i(this,A).config).onSettled)==null?void 0:y.call(l,m,null,this.state.variables,this.state.context,this)),await((R=(C=this.options).onSettled)==null?void 0:R.call(C,m,null,t,this.state.context)),f(this,N,W).call(this,{type:"success",data:m}),m}catch(m){try{throw await((v=(M=i(this,A).config).onError)==null?void 0:v.call(M,m,t,this.state.context,this)),await((b=(S=this.options).onError)==null?void 0:b.call(S,m,t,this.state.context)),await((Q=(P=i(this,A).config).onSettled)==null?void 0:Q.call(P,void 0,m,this.state.variables,this.state.context,this)),await((_=(k=this.options).onSettled)==null?void 0:_.call(k,void 0,m,t,this.state.context)),m}finally{f(this,N,W).call(this,{type:"error",error:m})}}finally{i(this,A).runNext(this)}}},G=new WeakMap,A=new WeakMap,at=new WeakMap,N=new WeakSet,W=function(t){const e=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),D.batch(()=>{i(this,G).forEach(s=>{s.onMutationUpdate(t)}),i(this,A).notify({mutation:this,type:"updated",action:t})})},Fe);function Le(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var T,At,Pe,Ye=(Pe=class extends Mt{constructor(e={}){super();u(this,T,void 0);u(this,At,void 0);this.config=e,h(this,T,new Map),h(this,At,Date.now())}build(e,s,n){const a=new Xe({mutationCache:this,mutationId:++Gt(this,At)._,options:e.defaultMutationOptions(s),state:n});return this.add(a),a}add(e){const s=Nt(e),n=i(this,T).get(s)??[];n.push(e),i(this,T).set(s,n),this.notify({type:"added",mutation:e})}remove(e){var n;const s=Nt(e);if(i(this,T).has(s)){const a=(n=i(this,T).get(s))==null?void 0:n.filter(c=>c!==e);a&&(a.length===0?i(this,T).delete(s):i(this,T).set(s,a))}this.notify({type:"removed",mutation:e})}canRun(e){var n;const s=(n=i(this,T).get(Nt(e)))==null?void 0:n.find(a=>a.state.status==="pending");return!s||s===e}runNext(e){var n;const s=(n=i(this,T).get(Nt(e)))==null?void 0:n.find(a=>a!==e&&a.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}clear(){D.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...i(this,T).values()].flat()}find(e){const s={exact:!0,...e};return this.getAll().find(n=>de(s,n))}findAll(e={}){return this.getAll().filter(s=>de(e,s))}notify(e){D.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){const e=this.getAll().filter(s=>s.state.isPaused);return D.batch(()=>Promise.all(e.map(s=>s.continue().catch(L))))}},T=new WeakMap,At=new WeakMap,Pe);function Nt(r){var t;return((t=r.options.scope)==null?void 0:t.id)??String(r.mutationId)}function Ze(r){return{onFetch:(t,e)=>{const s=async()=>{var C,R,M,v,S;const n=t.options,a=(M=(R=(C=t.fetchOptions)==null?void 0:C.meta)==null?void 0:R.fetchMore)==null?void 0:M.direction,c=((v=t.state.data)==null?void 0:v.pages)||[],d=((S=t.state.data)==null?void 0:S.pageParams)||[],w={pages:[],pageParams:[]};let g=!1;const p=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},o=Ae(t.options,t.fetchOptions),l=async(b,P,Q)=>{if(g)return Promise.reject();if(P==null&&b.pages.length)return Promise.resolve(b);const k={queryKey:t.queryKey,pageParam:P,direction:Q?"backward":"forward",meta:t.options.meta};p(k);const _=await o(k),{maxPages:m}=t.options,j=Q?Ne:Ge;return{pages:j(b.pages,_,m),pageParams:j(b.pageParams,P,m)}};let y;if(a&&c.length){const b=a==="backward",P=b?ts:pe,Q={pages:c,pageParams:d},k=P(n,Q);y=await l(Q,k,b)}else{y=await l(w,d[0]??n.initialPageParam);const b=r??c.length;for(let P=1;P<b;P++){const Q=pe(n,y);y=await l(y,Q)}}return y};t.options.persister?t.fetchFn=()=>{var n,a;return(a=(n=t.options).persister)==null?void 0:a.call(n,s,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},e)}:t.fetchFn=s}}}function pe(r,{pages:t,pageParams:e}){const s=t.length-1;return r.getNextPageParam(t[s],t,e[s],e)}function ts(r,{pages:t,pageParams:e}){var s;return(s=r.getPreviousPageParam)==null?void 0:s.call(r,t[0],t,e[0],e)}var F,X,Y,vt,bt,Z,gt,Ot,Ce,as=(Ce=class{constructor(t={}){u(this,F,void 0);u(this,X,void 0);u(this,Y,void 0);u(this,vt,void 0);u(this,bt,void 0);u(this,Z,void 0);u(this,gt,void 0);u(this,Ot,void 0);h(this,F,t.queryCache||new Je),h(this,X,t.mutationCache||new Ye),h(this,Y,t.defaultOptions||{}),h(this,vt,new Map),h(this,bt,new Map),h(this,Z,0)}mount(){Gt(this,Z)._++,i(this,Z)===1&&(h(this,gt,oe.subscribe(async t=>{t&&(await this.resumePausedMutations(),i(this,F).onFocus())})),h(this,Ot,$t.subscribe(async t=>{t&&(await this.resumePausedMutations(),i(this,F).onOnline())})))}unmount(){var t,e;Gt(this,Z)._--,i(this,Z)===0&&((t=i(this,gt))==null||t.call(this),h(this,gt,void 0),(e=i(this,Ot))==null||e.call(this),h(this,Ot,void 0))}isFetching(t){return i(this,F).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return i(this,X).findAll({...t,status:"pending"}).length}getQueryData(t){var s;const e=this.defaultQueryOptions({queryKey:t});return(s=i(this,F).get(e.queryHash))==null?void 0:s.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);if(e===void 0)return this.fetchQuery(t);{const s=this.defaultQueryOptions(t),n=i(this,F).build(this,s);return t.revalidateIfStale&&n.isStaleByTime(s.staleTime)&&this.prefetchQuery(s),Promise.resolve(e)}}getQueriesData(t){return i(this,F).findAll(t).map(({queryKey:e,state:s})=>{const n=s.data;return[e,n]})}setQueryData(t,e,s){const n=this.defaultQueryOptions({queryKey:t}),a=i(this,F).get(n.queryHash),c=a==null?void 0:a.state.data,d=ke(e,c);if(d!==void 0)return i(this,F).build(this,n).setData(d,{...s,manual:!0})}setQueriesData(t,e,s){return D.batch(()=>i(this,F).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,s)]))}getQueryState(t){var s;const e=this.defaultQueryOptions({queryKey:t});return(s=i(this,F).get(e.queryHash))==null?void 0:s.state}removeQueries(t){const e=i(this,F);D.batch(()=>{e.findAll(t).forEach(s=>{e.remove(s)})})}resetQueries(t,e){const s=i(this,F),n={type:"active",...t};return D.batch(()=>(s.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(n,e)))}cancelQueries(t={},e={}){const s={revert:!0,...e},n=D.batch(()=>i(this,F).findAll(t).map(a=>a.cancel(s)));return Promise.all(n).then(L).catch(L)}invalidateQueries(t={},e={}){return D.batch(()=>{if(i(this,F).findAll(t).forEach(n=>{n.invalidate()}),t.refetchType==="none")return Promise.resolve();const s={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(s,e)})}refetchQueries(t={},e){const s={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},n=D.batch(()=>i(this,F).findAll(t).filter(a=>!a.isDisabled()).map(a=>{let c=a.fetch(void 0,s);return s.throwOnError||(c=c.catch(L)),a.state.fetchStatus==="paused"?Promise.resolve():c}));return Promise.all(n).then(L)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const s=i(this,F).build(this,e);return s.isStaleByTime(e.staleTime)?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(L).catch(L)}fetchInfiniteQuery(t){return t.behavior=Ze(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(L).catch(L)}resumePausedMutations(){return $t.isOnline()?i(this,X).resumePausedMutations():Promise.resolve()}getQueryCache(){return i(this,F)}getMutationCache(){return i(this,X)}getDefaultOptions(){return i(this,Y)}setDefaultOptions(t){h(this,Y,t)}setQueryDefaults(t,e){i(this,vt).set(lt(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...i(this,vt).values()];let s={};return e.forEach(n=>{Dt(t,n.queryKey)&&(s={...s,...n.defaultOptions})}),s}setMutationDefaults(t,e){i(this,bt).set(lt(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...i(this,bt).values()];let s={};return e.forEach(n=>{Dt(t,n.mutationKey)&&(s={...s,...n.defaultOptions})}),s}defaultQueryOptions(t){if(t._defaulted)return t;const e={...i(this,Y).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=ue(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===Ee&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...i(this,Y).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){i(this,F).clear(),i(this,X).clear()}},F=new WeakMap,X=new WeakMap,Y=new WeakMap,vt=new WeakMap,bt=new WeakMap,Z=new WeakMap,gt=new WeakMap,Ot=new WeakMap,Ce),q,O,Ut,U,ht,wt,B,qt,St,Ft,ut,ot,tt,Pt,ct,Qt,It,Zt,Tt,te,Kt,ee,Lt,se,jt,ie,xt,re,kt,ne,zt,je,Re,us=(Re=class extends Mt{constructor(t,e){super();u(this,ct);u(this,It);u(this,Tt);u(this,Kt);u(this,Lt);u(this,jt);u(this,xt);u(this,kt);u(this,zt);u(this,q,void 0);u(this,O,void 0);u(this,Ut,void 0);u(this,U,void 0);u(this,ht,void 0);u(this,wt,void 0);u(this,B,void 0);u(this,qt,void 0);u(this,St,void 0);u(this,Ft,void 0);u(this,ut,void 0);u(this,ot,void 0);u(this,tt,void 0);u(this,Pt,new Set);this.options=e,h(this,q,t),h(this,B,null),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,O).addObserver(this),me(i(this,O),this.options)?f(this,ct,Qt).call(this):this.updateResult(),f(this,Lt,se).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ae(i(this,O),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ae(i(this,O),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,f(this,jt,ie).call(this),f(this,xt,re).call(this),i(this,O).removeObserver(this)}setOptions(t,e){const s=this.options,n=i(this,O);if(this.options=i(this,q).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");f(this,kt,ne).call(this),i(this,O).setOptions(this.options),s._defaulted&&!_t(this.options,s)&&i(this,q).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,O),observer:this});const a=this.hasListeners();a&&ve(i(this,O),n,this.options,s)&&f(this,ct,Qt).call(this),this.updateResult(e),a&&(i(this,O)!==n||this.options.enabled!==s.enabled||this.options.staleTime!==s.staleTime)&&f(this,It,Zt).call(this);const c=f(this,Tt,te).call(this);a&&(i(this,O)!==n||this.options.enabled!==s.enabled||c!==i(this,tt))&&f(this,Kt,ee).call(this,c)}getOptimisticResult(t){const e=i(this,q).getQueryCache().build(i(this,q),t),s=this.createResult(e,t);return ss(this,s)&&(h(this,U,s),h(this,wt,this.options),h(this,ht,i(this,O).state)),s}getCurrentResult(){return i(this,U)}trackResult(t,e){const s={};return Object.keys(t).forEach(n=>{Object.defineProperty(s,n,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(n),e==null||e(n),t[n])})}),s}trackProp(t){i(this,Pt).add(t)}getCurrentQuery(){return i(this,O)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=i(this,q).defaultQueryOptions(t),s=i(this,q).getQueryCache().build(i(this,q),e);return s.isFetchingOptimistic=!0,s.fetch().then(()=>this.createResult(s,e))}fetch(t){return f(this,ct,Qt).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,U)))}createResult(t,e){var _;const s=i(this,O),n=this.options,a=i(this,U),c=i(this,ht),d=i(this,wt),g=t!==s?t.state:i(this,Ut),{state:p}=t;let o={...p},l=!1,y;if(e._optimisticResults){const m=this.hasListeners(),j=!m&&me(t,e),xe=m&&ve(t,s,e,n);(j||xe)&&(o={...o,...Ke(p.data,t.options)}),e._optimisticResults==="isRestoring"&&(o.fetchStatus="idle")}let{error:C,errorUpdatedAt:R,status:M}=o;if(e.select&&o.data!==void 0)if(a&&o.data===(c==null?void 0:c.data)&&e.select===i(this,qt))y=i(this,St);else try{h(this,qt,e.select),y=e.select(o.data),y=Yt(a==null?void 0:a.data,y,e),h(this,St,y),h(this,B,null)}catch(m){h(this,B,m)}else y=o.data;if(e.placeholderData!==void 0&&y===void 0&&M==="pending"){let m;if(a!=null&&a.isPlaceholderData&&e.placeholderData===(d==null?void 0:d.placeholderData))m=a.data;else if(m=typeof e.placeholderData=="function"?e.placeholderData((_=i(this,Ft))==null?void 0:_.state.data,i(this,Ft)):e.placeholderData,e.select&&m!==void 0)try{m=e.select(m),h(this,B,null)}catch(j){h(this,B,j)}m!==void 0&&(M="success",y=Yt(a==null?void 0:a.data,m,e),l=!0)}i(this,B)&&(C=i(this,B),y=i(this,St),R=Date.now(),M="error");const v=o.fetchStatus==="fetching",S=M==="pending",b=M==="error",P=S&&v,Q=y!==void 0;return{status:M,fetchStatus:o.fetchStatus,isPending:S,isSuccess:M==="success",isError:b,isInitialLoading:P,isLoading:P,data:y,dataUpdatedAt:o.dataUpdatedAt,error:C,errorUpdatedAt:R,failureCount:o.fetchFailureCount,failureReason:o.fetchFailureReason,errorUpdateCount:o.errorUpdateCount,isFetched:o.dataUpdateCount>0||o.errorUpdateCount>0,isFetchedAfterMount:o.dataUpdateCount>g.dataUpdateCount||o.errorUpdateCount>g.errorUpdateCount,isFetching:v,isRefetching:v&&!S,isLoadingError:b&&!Q,isPaused:o.fetchStatus==="paused",isPlaceholderData:l,isRefetchError:b&&Q,isStale:ce(t,e),refetch:this.refetch}}updateResult(t){const e=i(this,U),s=this.createResult(i(this,O),this.options);if(h(this,ht,i(this,O).state),h(this,wt,this.options),i(this,ht).data!==void 0&&h(this,Ft,i(this,O)),_t(s,e))return;h(this,U,s);const n={},a=()=>{if(!e)return!0;const{notifyOnChangeProps:c}=this.options,d=typeof c=="function"?c():c;if(d==="all"||!d&&!i(this,Pt).size)return!0;const w=new Set(d??i(this,Pt));return this.options.throwOnError&&w.add("error"),Object.keys(i(this,U)).some(g=>{const p=g;return i(this,U)[p]!==e[p]&&w.has(p)})};(t==null?void 0:t.listeners)!==!1&&a()&&(n.listeners=!0),f(this,zt,je).call(this,{...n,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&f(this,Lt,se).call(this)}},q=new WeakMap,O=new WeakMap,Ut=new WeakMap,U=new WeakMap,ht=new WeakMap,wt=new WeakMap,B=new WeakMap,qt=new WeakMap,St=new WeakMap,Ft=new WeakMap,ut=new WeakMap,ot=new WeakMap,tt=new WeakMap,Pt=new WeakMap,ct=new WeakSet,Qt=function(t){f(this,kt,ne).call(this);let e=i(this,O).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(L)),e},It=new WeakSet,Zt=function(){if(f(this,jt,ie).call(this),Rt||i(this,U).isStale||!Jt(this.options.staleTime))return;const e=Qe(i(this,U).dataUpdatedAt,this.options.staleTime)+1;h(this,ut,setTimeout(()=>{i(this,U).isStale||this.updateResult()},e))},Tt=new WeakSet,te=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,O)):this.options.refetchInterval)??!1},Kt=new WeakSet,ee=function(t){f(this,xt,re).call(this),h(this,tt,t),!(Rt||this.options.enabled===!1||!Jt(i(this,tt))||i(this,tt)===0)&&h(this,ot,setInterval(()=>{(this.options.refetchIntervalInBackground||oe.isFocused())&&f(this,ct,Qt).call(this)},i(this,tt)))},Lt=new WeakSet,se=function(){f(this,It,Zt).call(this),f(this,Kt,ee).call(this,f(this,Tt,te).call(this))},jt=new WeakSet,ie=function(){i(this,ut)&&(clearTimeout(i(this,ut)),h(this,ut,void 0))},xt=new WeakSet,re=function(){i(this,ot)&&(clearInterval(i(this,ot)),h(this,ot,void 0))},kt=new WeakSet,ne=function(){const t=i(this,q).getQueryCache().build(i(this,q),this.options);if(t===i(this,O))return;const e=i(this,O);h(this,O,t),h(this,Ut,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},zt=new WeakSet,je=function(t){D.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(i(this,U))}),i(this,q).getQueryCache().notify({query:i(this,O),type:"observerResultsUpdated"})})},Re);function es(r,t){return t.enabled!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&t.retryOnMount===!1)}function me(r,t){return es(r,t)||r.state.data!==void 0&&ae(r,t,t.refetchOnMount)}function ae(r,t,e){if(t.enabled!==!1){const s=typeof e=="function"?e(r):e;return s==="always"||s!==!1&&ce(r,t)}return!1}function ve(r,t,e,s){return(r!==t||s.enabled===!1)&&(!e.suspense||r.state.status!=="error")&&ce(r,e)}function ce(r,t){return t.enabled!==!1&&r.isStaleByTime(t.staleTime)}function ss(r,t){return!_t(r.getCurrentResult(),t)}var et,st,I,z,Ct,Bt,Ht,he,Me,os=(Me=class extends Mt{constructor(t,e){super();u(this,Ct);u(this,Ht);u(this,et,void 0);u(this,st,void 0);u(this,I,void 0);u(this,z,void 0);h(this,et,t),this.setOptions(e),this.bindMethods(),f(this,Ct,Bt).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var s;const e=this.options;this.options=i(this,et).defaultMutationOptions(t),_t(this.options,e)||i(this,et).getMutationCache().notify({type:"observerOptionsUpdated",mutation:i(this,I),observer:this}),e!=null&&e.mutationKey&&this.options.mutationKey&&lt(e.mutationKey)!==lt(this.options.mutationKey)?this.reset():((s=i(this,I))==null?void 0:s.state.status)==="pending"&&i(this,I).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=i(this,I))==null||t.removeObserver(this)}onMutationUpdate(t){f(this,Ct,Bt).call(this),f(this,Ht,he).call(this,t)}getCurrentResult(){return i(this,st)}reset(){var t;(t=i(this,I))==null||t.removeObserver(this),h(this,I,void 0),f(this,Ct,Bt).call(this),f(this,Ht,he).call(this)}mutate(t,e){var s;return h(this,z,e),(s=i(this,I))==null||s.removeObserver(this),h(this,I,i(this,et).getMutationCache().build(i(this,et),this.options)),i(this,I).addObserver(this),i(this,I).execute(t)}},et=new WeakMap,st=new WeakMap,I=new WeakMap,z=new WeakMap,Ct=new WeakSet,Bt=function(){var e;const t=((e=i(this,I))==null?void 0:e.state)??Le();h(this,st,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},Ht=new WeakSet,he=function(t){D.batch(()=>{var e,s,n,a,c,d,w,g;if(i(this,z)&&this.hasListeners()){const p=i(this,st).variables,o=i(this,st).context;(t==null?void 0:t.type)==="success"?((s=(e=i(this,z)).onSuccess)==null||s.call(e,t.data,p,o),(a=(n=i(this,z)).onSettled)==null||a.call(n,t.data,null,p,o)):(t==null?void 0:t.type)==="error"&&((d=(c=i(this,z)).onError)==null||d.call(c,t.error,p,o),(g=(w=i(this,z)).onSettled)==null||g.call(w,void 0,t.error,p,o))}this.listeners.forEach(p=>{p(i(this,st))})})},Me);export{Ye as M,Je as Q,as as a,us as b,os as c,Rt as i};
