import{g as ge}from"./@babel-VbPd-4M3.js";var Le={},$t={},Y={},oe={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});function i(s,o){var x=s>>>16&65535,d=s&65535,I=o>>>16&65535,H=o&65535;return d*H+(x*H+d*I<<16>>>0)|0}r.mul=Math.imul||i;function a(s,o){return s+o|0}r.add=a;function v(s,o){return s-o|0}r.sub=v;function w(s,o){return s<<o|s>>>32-o}r.rotl=w;function j(s,o){return s<<32-o|s>>>o}r.rotr=j;function q(s){return typeof s=="number"&&isFinite(s)&&Math.floor(s)===s}r.isInteger=Number.isInteger||q,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(s){return r.isInteger(s)&&s>=-r.MAX_SAFE_INTEGER&&s<=r.MAX_SAFE_INTEGER}})(oe);Object.defineProperty(Y,"__esModule",{value:!0});var ce=oe;function Se(r,i){return i===void 0&&(i=0),(r[i+0]<<8|r[i+1])<<16>>16}Y.readInt16BE=Se;function Ue(r,i){return i===void 0&&(i=0),(r[i+0]<<8|r[i+1])>>>0}Y.readUint16BE=Ue;function Ae(r,i){return i===void 0&&(i=0),(r[i+1]<<8|r[i])<<16>>16}Y.readInt16LE=Ae;function He(r,i){return i===void 0&&(i=0),(r[i+1]<<8|r[i])>>>0}Y.readUint16LE=He;function ue(r,i,a){return i===void 0&&(i=new Uint8Array(2)),a===void 0&&(a=0),i[a+0]=r>>>8,i[a+1]=r>>>0,i}Y.writeUint16BE=ue;Y.writeInt16BE=ue;function _e(r,i,a){return i===void 0&&(i=new Uint8Array(2)),a===void 0&&(a=0),i[a+0]=r>>>0,i[a+1]=r>>>8,i}Y.writeUint16LE=_e;Y.writeInt16LE=_e;function Wt(r,i){return i===void 0&&(i=0),r[i]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3]}Y.readInt32BE=Wt;function kt(r,i){return i===void 0&&(i=0),(r[i]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3])>>>0}Y.readUint32BE=kt;function te(r,i){return i===void 0&&(i=0),r[i+3]<<24|r[i+2]<<16|r[i+1]<<8|r[i]}Y.readInt32LE=te;function ee(r,i){return i===void 0&&(i=0),(r[i+3]<<24|r[i+2]<<16|r[i+1]<<8|r[i])>>>0}Y.readUint32LE=ee;function Xt(r,i,a){return i===void 0&&(i=new Uint8Array(4)),a===void 0&&(a=0),i[a+0]=r>>>24,i[a+1]=r>>>16,i[a+2]=r>>>8,i[a+3]=r>>>0,i}Y.writeUint32BE=Xt;Y.writeInt32BE=Xt;function qt(r,i,a){return i===void 0&&(i=new Uint8Array(4)),a===void 0&&(a=0),i[a+0]=r>>>0,i[a+1]=r>>>8,i[a+2]=r>>>16,i[a+3]=r>>>24,i}Y.writeUint32LE=qt;Y.writeInt32LE=qt;function Me(r,i){i===void 0&&(i=0);var a=Wt(r,i),v=Wt(r,i+4);return a*4294967296+v-(v>>31)*4294967296}Y.readInt64BE=Me;function me(r,i){i===void 0&&(i=0);var a=kt(r,i),v=kt(r,i+4);return a*4294967296+v}Y.readUint64BE=me;function Be(r,i){i===void 0&&(i=0);var a=te(r,i),v=te(r,i+4);return v*4294967296+a-(a>>31)*4294967296}Y.readInt64LE=Be;function pe(r,i){i===void 0&&(i=0);var a=ee(r,i),v=ee(r,i+4);return v*4294967296+a}Y.readUint64LE=pe;function le(r,i,a){return i===void 0&&(i=new Uint8Array(8)),a===void 0&&(a=0),Xt(r/4294967296>>>0,i,a),Xt(r>>>0,i,a+4),i}Y.writeUint64BE=le;Y.writeInt64BE=le;function xe(r,i,a){return i===void 0&&(i=new Uint8Array(8)),a===void 0&&(a=0),qt(r>>>0,i,a),qt(r/4294967296>>>0,i,a+4),i}Y.writeUint64LE=xe;Y.writeInt64LE=xe;function Te(r,i,a){if(a===void 0&&(a=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>i.length-a)throw new Error("readUintBE: array is too short for the given bitLength");for(var v=0,w=1,j=r/8+a-1;j>=a;j--)v+=i[j]*w,w*=256;return v}Y.readUintBE=Te;function Ke(r,i,a){if(a===void 0&&(a=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>i.length-a)throw new Error("readUintLE: array is too short for the given bitLength");for(var v=0,w=1,j=a;j<a+r/8;j++)v+=i[j]*w,w*=256;return v}Y.readUintLE=Ke;function Ie(r,i,a,v){if(a===void 0&&(a=new Uint8Array(r/8)),v===void 0&&(v=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!ce.isSafeInteger(i))throw new Error("writeUintBE value must be an integer");for(var w=1,j=r/8+v-1;j>=v;j--)a[j]=i/w&255,w*=256;return a}Y.writeUintBE=Ie;function Ne(r,i,a,v){if(a===void 0&&(a=new Uint8Array(r/8)),v===void 0&&(v=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!ce.isSafeInteger(i))throw new Error("writeUintLE value must be an integer");for(var w=1,j=v;j<v+r/8;j++)a[j]=i/w&255,w*=256;return a}Y.writeUintLE=Ne;function Pe(r,i){i===void 0&&(i=0);var a=new DataView(r.buffer,r.byteOffset,r.byteLength);return a.getFloat32(i)}Y.readFloat32BE=Pe;function Ge(r,i){i===void 0&&(i=0);var a=new DataView(r.buffer,r.byteOffset,r.byteLength);return a.getFloat32(i,!0)}Y.readFloat32LE=Ge;function Ce(r,i){i===void 0&&(i=0);var a=new DataView(r.buffer,r.byteOffset,r.byteLength);return a.getFloat64(i)}Y.readFloat64BE=Ce;function Fe(r,i){i===void 0&&(i=0);var a=new DataView(r.buffer,r.byteOffset,r.byteLength);return a.getFloat64(i,!0)}Y.readFloat64LE=Fe;function Re(r,i,a){i===void 0&&(i=new Uint8Array(4)),a===void 0&&(a=0);var v=new DataView(i.buffer,i.byteOffset,i.byteLength);return v.setFloat32(a,r),i}Y.writeFloat32BE=Re;function Oe(r,i,a){i===void 0&&(i=new Uint8Array(4)),a===void 0&&(a=0);var v=new DataView(i.buffer,i.byteOffset,i.byteLength);return v.setFloat32(a,r,!0),i}Y.writeFloat32LE=Oe;function je(r,i,a){i===void 0&&(i=new Uint8Array(8)),a===void 0&&(a=0);var v=new DataView(i.buffer,i.byteOffset,i.byteLength);return v.setFloat64(a,r),i}Y.writeFloat64BE=je;function ze(r,i,a){i===void 0&&(i=new Uint8Array(8)),a===void 0&&(a=0);var v=new DataView(i.buffer,i.byteOffset,i.byteLength);return v.setFloat64(a,r,!0),i}Y.writeFloat64LE=ze;var Gt={};Object.defineProperty(Gt,"__esModule",{value:!0});function De(r){for(var i=0;i<r.length;i++)r[i]=0;return r}Gt.wipe=De;Object.defineProperty($t,"__esModule",{value:!0});var Pt=Y,re=Gt,Ye=20;function Xe(r,i,a){for(var v=1634760805,w=857760878,j=2036477234,q=1797285236,s=a[3]<<24|a[2]<<16|a[1]<<8|a[0],o=a[7]<<24|a[6]<<16|a[5]<<8|a[4],x=a[11]<<24|a[10]<<16|a[9]<<8|a[8],d=a[15]<<24|a[14]<<16|a[13]<<8|a[12],I=a[19]<<24|a[18]<<16|a[17]<<8|a[16],H=a[23]<<24|a[22]<<16|a[21]<<8|a[20],E=a[27]<<24|a[26]<<16|a[25]<<8|a[24],B=a[31]<<24|a[30]<<16|a[29]<<8|a[28],F=i[3]<<24|i[2]<<16|i[1]<<8|i[0],N=i[7]<<24|i[6]<<16|i[5]<<8|i[4],X=i[11]<<24|i[10]<<16|i[9]<<8|i[8],$=i[15]<<24|i[14]<<16|i[13]<<8|i[12],D=v,y=w,L=j,b=q,e=s,n=o,K=x,p=d,C=I,R=H,O=E,l=B,_=F,G=N,A=X,g=$,S=0;S<Ye;S+=2)D=D+e|0,_^=D,_=_>>>16|_<<16,C=C+_|0,e^=C,e=e>>>20|e<<12,y=y+n|0,G^=y,G=G>>>16|G<<16,R=R+G|0,n^=R,n=n>>>20|n<<12,L=L+K|0,A^=L,A=A>>>16|A<<16,O=O+A|0,K^=O,K=K>>>20|K<<12,b=b+p|0,g^=b,g=g>>>16|g<<16,l=l+g|0,p^=l,p=p>>>20|p<<12,L=L+K|0,A^=L,A=A>>>24|A<<8,O=O+A|0,K^=O,K=K>>>25|K<<7,b=b+p|0,g^=b,g=g>>>24|g<<8,l=l+g|0,p^=l,p=p>>>25|p<<7,y=y+n|0,G^=y,G=G>>>24|G<<8,R=R+G|0,n^=R,n=n>>>25|n<<7,D=D+e|0,_^=D,_=_>>>24|_<<8,C=C+_|0,e^=C,e=e>>>25|e<<7,D=D+n|0,g^=D,g=g>>>16|g<<16,O=O+g|0,n^=O,n=n>>>20|n<<12,y=y+K|0,_^=y,_=_>>>16|_<<16,l=l+_|0,K^=l,K=K>>>20|K<<12,L=L+p|0,G^=L,G=G>>>16|G<<16,C=C+G|0,p^=C,p=p>>>20|p<<12,b=b+e|0,A^=b,A=A>>>16|A<<16,R=R+A|0,e^=R,e=e>>>20|e<<12,L=L+p|0,G^=L,G=G>>>24|G<<8,C=C+G|0,p^=C,p=p>>>25|p<<7,b=b+e|0,A^=b,A=A>>>24|A<<8,R=R+A|0,e^=R,e=e>>>25|e<<7,y=y+K|0,_^=y,_=_>>>24|_<<8,l=l+_|0,K^=l,K=K>>>25|K<<7,D=D+n|0,g^=D,g=g>>>24|g<<8,O=O+g|0,n^=O,n=n>>>25|n<<7;Pt.writeUint32LE(D+v|0,r,0),Pt.writeUint32LE(y+w|0,r,4),Pt.writeUint32LE(L+j|0,r,8),Pt.writeUint32LE(b+q|0,r,12),Pt.writeUint32LE(e+s|0,r,16),Pt.writeUint32LE(n+o|0,r,20),Pt.writeUint32LE(K+x|0,r,24),Pt.writeUint32LE(p+d|0,r,28),Pt.writeUint32LE(C+I|0,r,32),Pt.writeUint32LE(R+H|0,r,36),Pt.writeUint32LE(O+E|0,r,40),Pt.writeUint32LE(l+B|0,r,44),Pt.writeUint32LE(_+F|0,r,48),Pt.writeUint32LE(G+N|0,r,52),Pt.writeUint32LE(A+X|0,r,56),Pt.writeUint32LE(g+$|0,r,60)}function be(r,i,a,v,w){if(w===void 0&&(w=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(v.length<a.length)throw new Error("ChaCha: destination is shorter than source");var j,q;if(w===0){if(i.length!==8&&i.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");j=new Uint8Array(16),q=j.length-i.length,j.set(i,q)}else{if(i.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");j=i,q=w}for(var s=new Uint8Array(64),o=0;o<a.length;o+=64){Xe(s,j,r);for(var x=o;x<o+64&&x<a.length;x++)v[x]=a[x]^s[x-o];$e(j,0,q)}return re.wipe(s),w===0&&re.wipe(j),v}$t.streamXOR=be;function qe(r,i,a,v){return v===void 0&&(v=0),re.wipe(a),be(r,i,a,a,v)}$t.stream=qe;function $e(r,i,a){for(var v=1;a--;)v=v+(r[i]&255)|0,r[i]=v&255,v>>>=8,i++;if(v>0)throw new Error("ChaCha: counter overflow")}var ve={},Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});function Ve(r,i,a){return~(r-1)&i|r-1&a}Rt.select=Ve;function Ze(r,i){return(r|0)-(i|0)-1>>>31&1}Rt.lessOrEqual=Ze;function de(r,i){if(r.length!==i.length)return 0;for(var a=0,v=0;v<r.length;v++)a|=r[v]^i[v];return 1&a-1>>>8}Rt.compare=de;function Qe(r,i){return r.length===0||i.length===0?!1:de(r,i)!==0}Rt.equal=Qe;(function(r){Object.defineProperty(r,"__esModule",{value:!0});var i=Rt,a=Gt;r.DIGEST_LENGTH=16;var v=function(){function q(s){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var o=s[0]|s[1]<<8;this._r[0]=o&8191;var x=s[2]|s[3]<<8;this._r[1]=(o>>>13|x<<3)&8191;var d=s[4]|s[5]<<8;this._r[2]=(x>>>10|d<<6)&7939;var I=s[6]|s[7]<<8;this._r[3]=(d>>>7|I<<9)&8191;var H=s[8]|s[9]<<8;this._r[4]=(I>>>4|H<<12)&255,this._r[5]=H>>>1&8190;var E=s[10]|s[11]<<8;this._r[6]=(H>>>14|E<<2)&8191;var B=s[12]|s[13]<<8;this._r[7]=(E>>>11|B<<5)&8065;var F=s[14]|s[15]<<8;this._r[8]=(B>>>8|F<<8)&8191,this._r[9]=F>>>5&127,this._pad[0]=s[16]|s[17]<<8,this._pad[1]=s[18]|s[19]<<8,this._pad[2]=s[20]|s[21]<<8,this._pad[3]=s[22]|s[23]<<8,this._pad[4]=s[24]|s[25]<<8,this._pad[5]=s[26]|s[27]<<8,this._pad[6]=s[28]|s[29]<<8,this._pad[7]=s[30]|s[31]<<8}return q.prototype._blocks=function(s,o,x){for(var d=this._fin?0:2048,I=this._h[0],H=this._h[1],E=this._h[2],B=this._h[3],F=this._h[4],N=this._h[5],X=this._h[6],$=this._h[7],D=this._h[8],y=this._h[9],L=this._r[0],b=this._r[1],e=this._r[2],n=this._r[3],K=this._r[4],p=this._r[5],C=this._r[6],R=this._r[7],O=this._r[8],l=this._r[9];x>=16;){var _=s[o+0]|s[o+1]<<8;I+=_&8191;var G=s[o+2]|s[o+3]<<8;H+=(_>>>13|G<<3)&8191;var A=s[o+4]|s[o+5]<<8;E+=(G>>>10|A<<6)&8191;var g=s[o+6]|s[o+7]<<8;B+=(A>>>7|g<<9)&8191;var S=s[o+8]|s[o+9]<<8;F+=(g>>>4|S<<12)&8191,N+=S>>>1&8191;var U=s[o+10]|s[o+11]<<8;X+=(S>>>14|U<<2)&8191;var M=s[o+12]|s[o+13]<<8;$+=(U>>>11|M<<5)&8191;var V=s[o+14]|s[o+15]<<8;D+=(M>>>8|V<<8)&8191,y+=V>>>5|d;var m=0,z=m;z+=I*L,z+=H*(5*l),z+=E*(5*O),z+=B*(5*R),z+=F*(5*C),m=z>>>13,z&=8191,z+=N*(5*p),z+=X*(5*K),z+=$*(5*n),z+=D*(5*e),z+=y*(5*b),m+=z>>>13,z&=8191;var J=m;J+=I*b,J+=H*L,J+=E*(5*l),J+=B*(5*O),J+=F*(5*R),m=J>>>13,J&=8191,J+=N*(5*C),J+=X*(5*p),J+=$*(5*K),J+=D*(5*n),J+=y*(5*e),m+=J>>>13,J&=8191;var tt=m;tt+=I*e,tt+=H*b,tt+=E*L,tt+=B*(5*l),tt+=F*(5*O),m=tt>>>13,tt&=8191,tt+=N*(5*R),tt+=X*(5*C),tt+=$*(5*p),tt+=D*(5*K),tt+=y*(5*n),m+=tt>>>13,tt&=8191;var c=m;c+=I*n,c+=H*e,c+=E*b,c+=B*L,c+=F*(5*l),m=c>>>13,c&=8191,c+=N*(5*O),c+=X*(5*R),c+=$*(5*C),c+=D*(5*p),c+=y*(5*K),m+=c>>>13,c&=8191;var u=m;u+=I*K,u+=H*n,u+=E*e,u+=B*b,u+=F*L,m=u>>>13,u&=8191,u+=N*(5*l),u+=X*(5*O),u+=$*(5*R),u+=D*(5*C),u+=y*(5*p),m+=u>>>13,u&=8191;var h=m;h+=I*p,h+=H*K,h+=E*n,h+=B*e,h+=F*b,m=h>>>13,h&=8191,h+=N*L,h+=X*(5*l),h+=$*(5*O),h+=D*(5*R),h+=y*(5*C),m+=h>>>13,h&=8191;var t=m;t+=I*C,t+=H*p,t+=E*K,t+=B*n,t+=F*e,m=t>>>13,t&=8191,t+=N*b,t+=X*L,t+=$*(5*l),t+=D*(5*O),t+=y*(5*R),m+=t>>>13,t&=8191;var f=m;f+=I*R,f+=H*C,f+=E*p,f+=B*K,f+=F*n,m=f>>>13,f&=8191,f+=N*e,f+=X*b,f+=$*L,f+=D*(5*l),f+=y*(5*O),m+=f>>>13,f&=8191;var T=m;T+=I*O,T+=H*R,T+=E*C,T+=B*p,T+=F*K,m=T>>>13,T&=8191,T+=N*n,T+=X*e,T+=$*b,T+=D*L,T+=y*(5*l),m+=T>>>13,T&=8191;var P=m;P+=I*l,P+=H*O,P+=E*R,P+=B*C,P+=F*p,m=P>>>13,P&=8191,P+=N*K,P+=X*n,P+=$*e,P+=D*b,P+=y*L,m+=P>>>13,P&=8191,m=(m<<2)+m|0,m=m+z|0,z=m&8191,m=m>>>13,J+=m,I=z,H=J,E=tt,B=c,F=u,N=h,X=t,$=f,D=T,y=P,o+=16,x-=16}this._h[0]=I,this._h[1]=H,this._h[2]=E,this._h[3]=B,this._h[4]=F,this._h[5]=N,this._h[6]=X,this._h[7]=$,this._h[8]=D,this._h[9]=y},q.prototype.finish=function(s,o){o===void 0&&(o=0);var x=new Uint16Array(10),d,I,H,E;if(this._leftover){for(E=this._leftover,this._buffer[E++]=1;E<16;E++)this._buffer[E]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(d=this._h[1]>>>13,this._h[1]&=8191,E=2;E<10;E++)this._h[E]+=d,d=this._h[E]>>>13,this._h[E]&=8191;for(this._h[0]+=d*5,d=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=d,d=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=d,x[0]=this._h[0]+5,d=x[0]>>>13,x[0]&=8191,E=1;E<10;E++)x[E]=this._h[E]+d,d=x[E]>>>13,x[E]&=8191;for(x[9]-=8192,I=(d^1)-1,E=0;E<10;E++)x[E]&=I;for(I=~I,E=0;E<10;E++)this._h[E]=this._h[E]&I|x[E];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,H=this._h[0]+this._pad[0],this._h[0]=H&65535,E=1;E<8;E++)H=(this._h[E]+this._pad[E]|0)+(H>>>16)|0,this._h[E]=H&65535;return s[o+0]=this._h[0]>>>0,s[o+1]=this._h[0]>>>8,s[o+2]=this._h[1]>>>0,s[o+3]=this._h[1]>>>8,s[o+4]=this._h[2]>>>0,s[o+5]=this._h[2]>>>8,s[o+6]=this._h[3]>>>0,s[o+7]=this._h[3]>>>8,s[o+8]=this._h[4]>>>0,s[o+9]=this._h[4]>>>8,s[o+10]=this._h[5]>>>0,s[o+11]=this._h[5]>>>8,s[o+12]=this._h[6]>>>0,s[o+13]=this._h[6]>>>8,s[o+14]=this._h[7]>>>0,s[o+15]=this._h[7]>>>8,this._finished=!0,this},q.prototype.update=function(s){var o=0,x=s.length,d;if(this._leftover){d=16-this._leftover,d>x&&(d=x);for(var I=0;I<d;I++)this._buffer[this._leftover+I]=s[o+I];if(x-=d,o+=d,this._leftover+=d,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(x>=16&&(d=x-x%16,this._blocks(s,o,d),o+=d,x-=d),x){for(var I=0;I<x;I++)this._buffer[this._leftover+I]=s[o+I];this._leftover+=x}return this},q.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var s=new Uint8Array(16);return this.finish(s),s},q.prototype.clean=function(){return a.wipe(this._buffer),a.wipe(this._r),a.wipe(this._h),a.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},q}();r.Poly1305=v;function w(q,s){var o=new v(q);o.update(s);var x=o.digest();return o.clean(),x}r.oneTimeAuth=w;function j(q,s){return q.length!==r.DIGEST_LENGTH||s.length!==r.DIGEST_LENGTH?!1:i.equal(q,s)}r.equal=j})(ve);(function(r){Object.defineProperty(r,"__esModule",{value:!0});var i=$t,a=ve,v=Gt,w=Y,j=Rt;r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var q=new Uint8Array(16),s=function(){function o(x){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,x.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(x)}return o.prototype.seal=function(x,d,I,H){if(x.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var E=new Uint8Array(16);E.set(x,E.length-x.length);var B=new Uint8Array(32);i.stream(this._key,E,B,4);var F=d.length+this.tagLength,N;if(H){if(H.length!==F)throw new Error("ChaCha20Poly1305: incorrect destination length");N=H}else N=new Uint8Array(F);return i.streamXOR(this._key,E,d,N,4),this._authenticate(N.subarray(N.length-this.tagLength,N.length),B,N.subarray(0,N.length-this.tagLength),I),v.wipe(E),N},o.prototype.open=function(x,d,I,H){if(x.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(d.length<this.tagLength)return null;var E=new Uint8Array(16);E.set(x,E.length-x.length);var B=new Uint8Array(32);i.stream(this._key,E,B,4);var F=new Uint8Array(this.tagLength);if(this._authenticate(F,B,d.subarray(0,d.length-this.tagLength),I),!j.equal(F,d.subarray(d.length-this.tagLength,d.length)))return null;var N=d.length-this.tagLength,X;if(H){if(H.length!==N)throw new Error("ChaCha20Poly1305: incorrect destination length");X=H}else X=new Uint8Array(N);return i.streamXOR(this._key,E,d.subarray(0,d.length-this.tagLength),X,4),v.wipe(E),X},o.prototype.clean=function(){return v.wipe(this._key),this},o.prototype._authenticate=function(x,d,I,H){var E=new a.Poly1305(d);H&&(E.update(H),H.length%16>0&&E.update(q.subarray(H.length%16))),E.update(I),I.length%16>0&&E.update(q.subarray(I.length%16));var B=new Uint8Array(8);H&&w.writeUint64LE(H.length,B),E.update(B),w.writeUint64LE(I.length,B),E.update(B);for(var F=E.digest(),N=0;N<F.length;N++)x[N]=F[N];E.clean(),v.wipe(F),v.wipe(B)},o}();r.ChaCha20Poly1305=s})(Le);var we={},Dt={},ie={};Object.defineProperty(ie,"__esModule",{value:!0});function Je(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}ie.isSerializableHash=Je;Object.defineProperty(Dt,"__esModule",{value:!0});var Ct=ie,We=Rt,ke=Gt,Ee=function(){function r(i,a){this._finished=!1,this._inner=new i,this._outer=new i,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var v=new Uint8Array(this.blockSize);a.length>this.blockSize?this._inner.update(a).finish(v).clean():v.set(a);for(var w=0;w<v.length;w++)v[w]^=54;this._inner.update(v);for(var w=0;w<v.length;w++)v[w]^=106;this._outer.update(v),Ct.isSerializableHash(this._inner)&&Ct.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),ke.wipe(v)}return r.prototype.reset=function(){if(!Ct.isSerializableHash(this._inner)||!Ct.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){Ct.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ct.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(i){return this._inner.update(i),this},r.prototype.finish=function(i){return this._finished?(this._outer.finish(i),this):(this._inner.finish(i),this._outer.update(i.subarray(0,this.digestLength)).finish(i),this._finished=!0,this)},r.prototype.digest=function(){var i=new Uint8Array(this.digestLength);return this.finish(i),i},r.prototype.saveState=function(){if(!Ct.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(i){if(!Ct.isSerializableHash(this._inner)||!Ct.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(i),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(i){if(!Ct.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(i)},r}();Dt.HMAC=Ee;function tr(r,i,a){var v=new Ee(r,i);v.update(a);var w=v.digest();return v.clean(),w}Dt.hmac=tr;Dt.equal=We.equal;Object.defineProperty(we,"__esModule",{value:!0});var ae=Dt,he=Gt,er=function(){function r(i,a,v,w){v===void 0&&(v=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=i,this._info=w;var j=ae.hmac(this._hash,v,a);this._hmac=new ae.HMAC(i,j),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var i=this._counter[0];if(i===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),i>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(i){for(var a=new Uint8Array(i),v=0;v<a.length;v++)this._bufpos===this._buffer.length&&this._fillBuffer(),a[v]=this._buffer[this._bufpos++];return a},r.prototype.clean=function(){this._hmac.clean(),he.wipe(this._buffer),he.wipe(this._counter),this._bufpos=0},r}(),vr=we.HKDF=er,fe={},Vt={},Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.BrowserRandomSource=void 0;const se=65536;class rr{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const i=typeof self<"u"?self.crypto||self.msCrypto:null;i&&i.getRandomValues!==void 0&&(this._crypto=i,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(i){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const a=new Uint8Array(i);for(let v=0;v<a.length;v+=se)this._crypto.getRandomValues(a.subarray(v,v+Math.min(a.length-v,se)));return a}}Zt.BrowserRandomSource=rr;function ir(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Qt={};const fr={},nr=Object.freeze(Object.defineProperty({__proto__:null,default:fr},Symbol.toStringTag,{value:"Module"})),ar=ge(nr);Object.defineProperty(Qt,"__esModule",{value:!0});Qt.NodeRandomSource=void 0;const hr=Gt;class sr{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof ir<"u"){const i=ar;i&&i.randomBytes&&(this._crypto=i,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(i){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let a=this._crypto.randomBytes(i);if(a.length!==i)throw new Error("NodeRandomSource: got fewer bytes than requested");const v=new Uint8Array(i);for(let w=0;w<v.length;w++)v[w]=a[w];return(0,hr.wipe)(a),v}}Qt.NodeRandomSource=sr;Object.defineProperty(Vt,"__esModule",{value:!0});Vt.SystemRandomSource=void 0;const or=Zt,cr=Qt;class ur{constructor(){if(this.isAvailable=!1,this.name="",this._source=new or.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new cr.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(i){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(i)}}Vt.SystemRandomSource=ur;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const i=Vt,a=Y,v=Gt;r.defaultRandomSource=new i.SystemRandomSource;function w(x,d=r.defaultRandomSource){return d.randomBytes(x)}r.randomBytes=w;function j(x=r.defaultRandomSource){const d=w(4,x),I=(0,a.readUint32LE)(d);return(0,v.wipe)(d),I}r.randomUint32=j;const q="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function s(x,d=q,I=r.defaultRandomSource){if(d.length<2)throw new Error("randomString charset is too short");if(d.length>256)throw new Error("randomString charset is too long");let H="";const E=d.length,B=256-256%E;for(;x>0;){const F=w(Math.ceil(x*256/B),I);for(let N=0;N<F.length&&x>0;N++){const X=F[N];X<B&&(H+=d.charAt(X%E),x--)}(0,v.wipe)(F)}return H}r.randomString=s;function o(x,d=q,I=r.defaultRandomSource){const H=Math.ceil(x/(Math.log(d.length)/Math.LN2));return s(H,d,I)}r.randomStringForEntropy=o})(fe);var _r={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var i=Y,a=Gt;r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var v=function(){function s(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return s.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},s.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},s.prototype.clean=function(){a.wipe(this._buffer),a.wipe(this._temp),this.reset()},s.prototype.update=function(o,x){if(x===void 0&&(x=o.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var d=0;if(this._bytesHashed+=x,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&x>0;)this._buffer[this._bufferLength++]=o[d++],x--;this._bufferLength===this.blockSize&&(j(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(x>=this.blockSize&&(d=j(this._temp,this._state,o,d,x),x%=this.blockSize);x>0;)this._buffer[this._bufferLength++]=o[d++],x--;return this},s.prototype.finish=function(o){if(!this._finished){var x=this._bytesHashed,d=this._bufferLength,I=x/536870912|0,H=x<<3,E=x%64<56?64:128;this._buffer[d]=128;for(var B=d+1;B<E-8;B++)this._buffer[B]=0;i.writeUint32BE(I,this._buffer,E-8),i.writeUint32BE(H,this._buffer,E-4),j(this._temp,this._state,this._buffer,0,E),this._finished=!0}for(var B=0;B<this.digestLength/4;B++)i.writeUint32BE(this._state[B],o,B*4);return this},s.prototype.digest=function(){var o=new Uint8Array(this.digestLength);return this.finish(o),o},s.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},s.prototype.restoreState=function(o){return this._state.set(o.state),this._bufferLength=o.bufferLength,o.buffer&&this._buffer.set(o.buffer),this._bytesHashed=o.bytesHashed,this._finished=!1,this},s.prototype.cleanSavedState=function(o){a.wipe(o.state),o.buffer&&a.wipe(o.buffer),o.bufferLength=0,o.bytesHashed=0},s}();r.SHA256=v;var w=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function j(s,o,x,d,I){for(;I>=64;){for(var H=o[0],E=o[1],B=o[2],F=o[3],N=o[4],X=o[5],$=o[6],D=o[7],y=0;y<16;y++){var L=d+y*4;s[y]=i.readUint32BE(x,L)}for(var y=16;y<64;y++){var b=s[y-2],e=(b>>>17|b<<15)^(b>>>19|b<<13)^b>>>10;b=s[y-15];var n=(b>>>7|b<<25)^(b>>>18|b<<14)^b>>>3;s[y]=(e+s[y-7]|0)+(n+s[y-16]|0)}for(var y=0;y<64;y++){var e=(((N>>>6|N<<26)^(N>>>11|N<<21)^(N>>>25|N<<7))+(N&X^~N&$)|0)+(D+(w[y]+s[y]|0)|0)|0,n=((H>>>2|H<<30)^(H>>>13|H<<19)^(H>>>22|H<<10))+(H&E^H&B^E&B)|0;D=$,$=X,X=N,N=F+e|0,F=B,B=E,E=H,H=e+n|0}o[0]+=H,o[1]+=E,o[2]+=B,o[3]+=F,o[4]+=N,o[5]+=X,o[6]+=$,o[7]+=D,d+=64,I-=64}return d}function q(s){var o=new v;o.update(s);var x=o.digest();return o.clean(),x}r.hash=q})(_r);var lr={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const i=fe,a=Gt;r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function v(y){const L=new Float64Array(16);if(y)for(let b=0;b<y.length;b++)L[b]=y[b];return L}const w=new Uint8Array(32);w[0]=9;const j=v([56129,1]);function q(y){let L=1;for(let b=0;b<16;b++){let e=y[b]+L+65535;L=Math.floor(e/65536),y[b]=e-L*65536}y[0]+=L-1+37*(L-1)}function s(y,L,b){const e=~(b-1);for(let n=0;n<16;n++){const K=e&(y[n]^L[n]);y[n]^=K,L[n]^=K}}function o(y,L){const b=v(),e=v();for(let n=0;n<16;n++)e[n]=L[n];q(e),q(e),q(e);for(let n=0;n<2;n++){b[0]=e[0]-65517;for(let p=1;p<15;p++)b[p]=e[p]-65535-(b[p-1]>>16&1),b[p-1]&=65535;b[15]=e[15]-32767-(b[14]>>16&1);const K=b[15]>>16&1;b[14]&=65535,s(e,b,1-K)}for(let n=0;n<16;n++)y[2*n]=e[n]&255,y[2*n+1]=e[n]>>8}function x(y,L){for(let b=0;b<16;b++)y[b]=L[2*b]+(L[2*b+1]<<8);y[15]&=32767}function d(y,L,b){for(let e=0;e<16;e++)y[e]=L[e]+b[e]}function I(y,L,b){for(let e=0;e<16;e++)y[e]=L[e]-b[e]}function H(y,L,b){let e,n,K=0,p=0,C=0,R=0,O=0,l=0,_=0,G=0,A=0,g=0,S=0,U=0,M=0,V=0,m=0,z=0,J=0,tt=0,c=0,u=0,h=0,t=0,f=0,T=0,P=0,it=0,ot=0,ft=0,_t=0,wt=0,dt=0,ht=b[0],nt=b[1],rt=b[2],et=b[3],k=b[4],W=b[5],Z=b[6],Q=b[7],at=b[8],st=b[9],ct=b[10],ut=b[11],lt=b[12],xt=b[13],bt=b[14],vt=b[15];e=L[0],K+=e*ht,p+=e*nt,C+=e*rt,R+=e*et,O+=e*k,l+=e*W,_+=e*Z,G+=e*Q,A+=e*at,g+=e*st,S+=e*ct,U+=e*ut,M+=e*lt,V+=e*xt,m+=e*bt,z+=e*vt,e=L[1],p+=e*ht,C+=e*nt,R+=e*rt,O+=e*et,l+=e*k,_+=e*W,G+=e*Z,A+=e*Q,g+=e*at,S+=e*st,U+=e*ct,M+=e*ut,V+=e*lt,m+=e*xt,z+=e*bt,J+=e*vt,e=L[2],C+=e*ht,R+=e*nt,O+=e*rt,l+=e*et,_+=e*k,G+=e*W,A+=e*Z,g+=e*Q,S+=e*at,U+=e*st,M+=e*ct,V+=e*ut,m+=e*lt,z+=e*xt,J+=e*bt,tt+=e*vt,e=L[3],R+=e*ht,O+=e*nt,l+=e*rt,_+=e*et,G+=e*k,A+=e*W,g+=e*Z,S+=e*Q,U+=e*at,M+=e*st,V+=e*ct,m+=e*ut,z+=e*lt,J+=e*xt,tt+=e*bt,c+=e*vt,e=L[4],O+=e*ht,l+=e*nt,_+=e*rt,G+=e*et,A+=e*k,g+=e*W,S+=e*Z,U+=e*Q,M+=e*at,V+=e*st,m+=e*ct,z+=e*ut,J+=e*lt,tt+=e*xt,c+=e*bt,u+=e*vt,e=L[5],l+=e*ht,_+=e*nt,G+=e*rt,A+=e*et,g+=e*k,S+=e*W,U+=e*Z,M+=e*Q,V+=e*at,m+=e*st,z+=e*ct,J+=e*ut,tt+=e*lt,c+=e*xt,u+=e*bt,h+=e*vt,e=L[6],_+=e*ht,G+=e*nt,A+=e*rt,g+=e*et,S+=e*k,U+=e*W,M+=e*Z,V+=e*Q,m+=e*at,z+=e*st,J+=e*ct,tt+=e*ut,c+=e*lt,u+=e*xt,h+=e*bt,t+=e*vt,e=L[7],G+=e*ht,A+=e*nt,g+=e*rt,S+=e*et,U+=e*k,M+=e*W,V+=e*Z,m+=e*Q,z+=e*at,J+=e*st,tt+=e*ct,c+=e*ut,u+=e*lt,h+=e*xt,t+=e*bt,f+=e*vt,e=L[8],A+=e*ht,g+=e*nt,S+=e*rt,U+=e*et,M+=e*k,V+=e*W,m+=e*Z,z+=e*Q,J+=e*at,tt+=e*st,c+=e*ct,u+=e*ut,h+=e*lt,t+=e*xt,f+=e*bt,T+=e*vt,e=L[9],g+=e*ht,S+=e*nt,U+=e*rt,M+=e*et,V+=e*k,m+=e*W,z+=e*Z,J+=e*Q,tt+=e*at,c+=e*st,u+=e*ct,h+=e*ut,t+=e*lt,f+=e*xt,T+=e*bt,P+=e*vt,e=L[10],S+=e*ht,U+=e*nt,M+=e*rt,V+=e*et,m+=e*k,z+=e*W,J+=e*Z,tt+=e*Q,c+=e*at,u+=e*st,h+=e*ct,t+=e*ut,f+=e*lt,T+=e*xt,P+=e*bt,it+=e*vt,e=L[11],U+=e*ht,M+=e*nt,V+=e*rt,m+=e*et,z+=e*k,J+=e*W,tt+=e*Z,c+=e*Q,u+=e*at,h+=e*st,t+=e*ct,f+=e*ut,T+=e*lt,P+=e*xt,it+=e*bt,ot+=e*vt,e=L[12],M+=e*ht,V+=e*nt,m+=e*rt,z+=e*et,J+=e*k,tt+=e*W,c+=e*Z,u+=e*Q,h+=e*at,t+=e*st,f+=e*ct,T+=e*ut,P+=e*lt,it+=e*xt,ot+=e*bt,ft+=e*vt,e=L[13],V+=e*ht,m+=e*nt,z+=e*rt,J+=e*et,tt+=e*k,c+=e*W,u+=e*Z,h+=e*Q,t+=e*at,f+=e*st,T+=e*ct,P+=e*ut,it+=e*lt,ot+=e*xt,ft+=e*bt,_t+=e*vt,e=L[14],m+=e*ht,z+=e*nt,J+=e*rt,tt+=e*et,c+=e*k,u+=e*W,h+=e*Z,t+=e*Q,f+=e*at,T+=e*st,P+=e*ct,it+=e*ut,ot+=e*lt,ft+=e*xt,_t+=e*bt,wt+=e*vt,e=L[15],z+=e*ht,J+=e*nt,tt+=e*rt,c+=e*et,u+=e*k,h+=e*W,t+=e*Z,f+=e*Q,T+=e*at,P+=e*st,it+=e*ct,ot+=e*ut,ft+=e*lt,_t+=e*xt,wt+=e*bt,dt+=e*vt,K+=38*J,p+=38*tt,C+=38*c,R+=38*u,O+=38*h,l+=38*t,_+=38*f,G+=38*T,A+=38*P,g+=38*it,S+=38*ot,U+=38*ft,M+=38*_t,V+=38*wt,m+=38*dt,n=1,e=K+n+65535,n=Math.floor(e/65536),K=e-n*65536,e=p+n+65535,n=Math.floor(e/65536),p=e-n*65536,e=C+n+65535,n=Math.floor(e/65536),C=e-n*65536,e=R+n+65535,n=Math.floor(e/65536),R=e-n*65536,e=O+n+65535,n=Math.floor(e/65536),O=e-n*65536,e=l+n+65535,n=Math.floor(e/65536),l=e-n*65536,e=_+n+65535,n=Math.floor(e/65536),_=e-n*65536,e=G+n+65535,n=Math.floor(e/65536),G=e-n*65536,e=A+n+65535,n=Math.floor(e/65536),A=e-n*65536,e=g+n+65535,n=Math.floor(e/65536),g=e-n*65536,e=S+n+65535,n=Math.floor(e/65536),S=e-n*65536,e=U+n+65535,n=Math.floor(e/65536),U=e-n*65536,e=M+n+65535,n=Math.floor(e/65536),M=e-n*65536,e=V+n+65535,n=Math.floor(e/65536),V=e-n*65536,e=m+n+65535,n=Math.floor(e/65536),m=e-n*65536,e=z+n+65535,n=Math.floor(e/65536),z=e-n*65536,K+=n-1+37*(n-1),n=1,e=K+n+65535,n=Math.floor(e/65536),K=e-n*65536,e=p+n+65535,n=Math.floor(e/65536),p=e-n*65536,e=C+n+65535,n=Math.floor(e/65536),C=e-n*65536,e=R+n+65535,n=Math.floor(e/65536),R=e-n*65536,e=O+n+65535,n=Math.floor(e/65536),O=e-n*65536,e=l+n+65535,n=Math.floor(e/65536),l=e-n*65536,e=_+n+65535,n=Math.floor(e/65536),_=e-n*65536,e=G+n+65535,n=Math.floor(e/65536),G=e-n*65536,e=A+n+65535,n=Math.floor(e/65536),A=e-n*65536,e=g+n+65535,n=Math.floor(e/65536),g=e-n*65536,e=S+n+65535,n=Math.floor(e/65536),S=e-n*65536,e=U+n+65535,n=Math.floor(e/65536),U=e-n*65536,e=M+n+65535,n=Math.floor(e/65536),M=e-n*65536,e=V+n+65535,n=Math.floor(e/65536),V=e-n*65536,e=m+n+65535,n=Math.floor(e/65536),m=e-n*65536,e=z+n+65535,n=Math.floor(e/65536),z=e-n*65536,K+=n-1+37*(n-1),y[0]=K,y[1]=p,y[2]=C,y[3]=R,y[4]=O,y[5]=l,y[6]=_,y[7]=G,y[8]=A,y[9]=g,y[10]=S,y[11]=U,y[12]=M,y[13]=V,y[14]=m,y[15]=z}function E(y,L){H(y,L,L)}function B(y,L){const b=v();for(let e=0;e<16;e++)b[e]=L[e];for(let e=253;e>=0;e--)E(b,b),e!==2&&e!==4&&H(b,b,L);for(let e=0;e<16;e++)y[e]=b[e]}function F(y,L){const b=new Uint8Array(32),e=new Float64Array(80),n=v(),K=v(),p=v(),C=v(),R=v(),O=v();for(let A=0;A<31;A++)b[A]=y[A];b[31]=y[31]&127|64,b[0]&=248,x(e,L);for(let A=0;A<16;A++)K[A]=e[A];n[0]=C[0]=1;for(let A=254;A>=0;--A){const g=b[A>>>3]>>>(A&7)&1;s(n,K,g),s(p,C,g),d(R,n,p),I(n,n,p),d(p,K,C),I(K,K,C),E(C,R),E(O,n),H(n,p,n),H(p,K,R),d(R,n,p),I(n,n,p),E(K,n),I(p,C,O),H(n,p,j),d(n,n,C),H(p,p,n),H(n,C,O),H(C,K,e),E(K,R),s(n,K,g),s(p,C,g)}for(let A=0;A<16;A++)e[A+16]=n[A],e[A+32]=p[A],e[A+48]=K[A],e[A+64]=C[A];const l=e.subarray(32),_=e.subarray(16);B(l,l),H(_,_,l);const G=new Uint8Array(32);return o(G,_),G}r.scalarMult=F;function N(y){return F(y,w)}r.scalarMultBase=N;function X(y){if(y.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const L=new Uint8Array(y);return{publicKey:N(L),secretKey:L}}r.generateKeyPairFromSeed=X;function $(y){const L=(0,i.randomBytes)(32,y),b=X(L);return(0,a.wipe)(L),b}r.generateKeyPair=$;function D(y,L,b=!1){if(y.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(L.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const e=F(y,L);if(b){let n=0;for(let K=0;K<e.length;K++)n|=e[K];if(n===0)throw new Error("X25519: invalid shared key")}return e}r.sharedKey=D})(lr);var xr={},ye={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var i=Y,a=Gt;r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var v=function(){function s(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return s.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},s.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},s.prototype.clean=function(){a.wipe(this._buffer),a.wipe(this._tempHi),a.wipe(this._tempLo),this.reset()},s.prototype.update=function(o,x){if(x===void 0&&(x=o.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var d=0;if(this._bytesHashed+=x,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&x>0;)this._buffer[this._bufferLength++]=o[d++],x--;this._bufferLength===this.blockSize&&(j(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(x>=this.blockSize&&(d=j(this._tempHi,this._tempLo,this._stateHi,this._stateLo,o,d,x),x%=this.blockSize);x>0;)this._buffer[this._bufferLength++]=o[d++],x--;return this},s.prototype.finish=function(o){if(!this._finished){var x=this._bytesHashed,d=this._bufferLength,I=x/536870912|0,H=x<<3,E=x%128<112?128:256;this._buffer[d]=128;for(var B=d+1;B<E-8;B++)this._buffer[B]=0;i.writeUint32BE(I,this._buffer,E-8),i.writeUint32BE(H,this._buffer,E-4),j(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,E),this._finished=!0}for(var B=0;B<this.digestLength/8;B++)i.writeUint32BE(this._stateHi[B],o,B*8),i.writeUint32BE(this._stateLo[B],o,B*8+4);return this},s.prototype.digest=function(){var o=new Uint8Array(this.digestLength);return this.finish(o),o},s.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},s.prototype.restoreState=function(o){return this._stateHi.set(o.stateHi),this._stateLo.set(o.stateLo),this._bufferLength=o.bufferLength,o.buffer&&this._buffer.set(o.buffer),this._bytesHashed=o.bytesHashed,this._finished=!1,this},s.prototype.cleanSavedState=function(o){a.wipe(o.stateHi),a.wipe(o.stateLo),o.buffer&&a.wipe(o.buffer),o.bufferLength=0,o.bytesHashed=0},s}();r.SHA512=v;var w=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function j(s,o,x,d,I,H,E){for(var B=x[0],F=x[1],N=x[2],X=x[3],$=x[4],D=x[5],y=x[6],L=x[7],b=d[0],e=d[1],n=d[2],K=d[3],p=d[4],C=d[5],R=d[6],O=d[7],l,_,G,A,g,S,U,M;E>=128;){for(var V=0;V<16;V++){var m=8*V+H;s[V]=i.readUint32BE(I,m),o[V]=i.readUint32BE(I,m+4)}for(var V=0;V<80;V++){var z=B,J=F,tt=N,c=X,u=$,h=D,t=y,f=L,T=b,P=e,it=n,ot=K,ft=p,_t=C,wt=R,dt=O;if(l=L,_=O,g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=($>>>14|p<<18)^($>>>18|p<<14)^(p>>>9|$<<23),_=(p>>>14|$<<18)^(p>>>18|$<<14)^($>>>9|p<<23),g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,l=$&D^~$&y,_=p&C^~p&R,g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,l=w[V*2],_=w[V*2+1],g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,l=s[V%16],_=o[V%16],g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,G=U&65535|M<<16,A=g&65535|S<<16,l=G,_=A,g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=(B>>>28|b<<4)^(b>>>2|B<<30)^(b>>>7|B<<25),_=(b>>>28|B<<4)^(B>>>2|b<<30)^(B>>>7|b<<25),g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,l=B&F^B&N^F&N,_=b&e^b&n^e&n,g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,f=U&65535|M<<16,dt=g&65535|S<<16,l=c,_=ot,g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=G,_=A,g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,c=U&65535|M<<16,ot=g&65535|S<<16,F=z,N=J,X=tt,$=c,D=u,y=h,L=t,B=f,e=T,n=P,K=it,p=ot,C=ft,R=_t,O=wt,b=dt,V%16===15)for(var m=0;m<16;m++)l=s[m],_=o[m],g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=s[(m+9)%16],_=o[(m+9)%16],g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,G=s[(m+1)%16],A=o[(m+1)%16],l=(G>>>1|A<<31)^(G>>>8|A<<24)^G>>>7,_=(A>>>1|G<<31)^(A>>>8|G<<24)^(A>>>7|G<<25),g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,G=s[(m+14)%16],A=o[(m+14)%16],l=(G>>>19|A<<13)^(A>>>29|G<<3)^G>>>6,_=(A>>>19|G<<13)^(G>>>29|A<<3)^(A>>>6|G<<26),g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,s[m]=U&65535|M<<16,o[m]=g&65535|S<<16}l=B,_=b,g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=x[0],_=d[0],g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,x[0]=B=U&65535|M<<16,d[0]=b=g&65535|S<<16,l=F,_=e,g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=x[1],_=d[1],g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,x[1]=F=U&65535|M<<16,d[1]=e=g&65535|S<<16,l=N,_=n,g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=x[2],_=d[2],g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,x[2]=N=U&65535|M<<16,d[2]=n=g&65535|S<<16,l=X,_=K,g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=x[3],_=d[3],g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,x[3]=X=U&65535|M<<16,d[3]=K=g&65535|S<<16,l=$,_=p,g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=x[4],_=d[4],g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,x[4]=$=U&65535|M<<16,d[4]=p=g&65535|S<<16,l=D,_=C,g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=x[5],_=d[5],g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,x[5]=D=U&65535|M<<16,d[5]=C=g&65535|S<<16,l=y,_=R,g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=x[6],_=d[6],g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,x[6]=y=U&65535|M<<16,d[6]=R=g&65535|S<<16,l=L,_=O,g=_&65535,S=_>>>16,U=l&65535,M=l>>>16,l=x[7],_=d[7],g+=_&65535,S+=_>>>16,U+=l&65535,M+=l>>>16,S+=g>>>16,U+=S>>>16,M+=U>>>16,x[7]=L=U&65535|M<<16,d[7]=O=g&65535|S<<16,H+=128,E-=128}return H}function q(s){var o=new v;o.update(s);var x=o.digest();return o.clean(),x}r.hash=q})(ye);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const i=fe,a=ye,v=Gt;r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function w(c){const u=new Float64Array(16);if(c)for(let h=0;h<c.length;h++)u[h]=c[h];return u}const j=new Uint8Array(32);j[0]=9;const q=w(),s=w([1]),o=w([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),x=w([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=w([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),I=w([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),H=w([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function E(c,u){for(let h=0;h<16;h++)c[h]=u[h]|0}function B(c){let u=1;for(let h=0;h<16;h++){let t=c[h]+u+65535;u=Math.floor(t/65536),c[h]=t-u*65536}c[0]+=u-1+37*(u-1)}function F(c,u,h){const t=~(h-1);for(let f=0;f<16;f++){const T=t&(c[f]^u[f]);c[f]^=T,u[f]^=T}}function N(c,u){const h=w(),t=w();for(let f=0;f<16;f++)t[f]=u[f];B(t),B(t),B(t);for(let f=0;f<2;f++){h[0]=t[0]-65517;for(let P=1;P<15;P++)h[P]=t[P]-65535-(h[P-1]>>16&1),h[P-1]&=65535;h[15]=t[15]-32767-(h[14]>>16&1);const T=h[15]>>16&1;h[14]&=65535,F(t,h,1-T)}for(let f=0;f<16;f++)c[2*f]=t[f]&255,c[2*f+1]=t[f]>>8}function X(c,u){let h=0;for(let t=0;t<32;t++)h|=c[t]^u[t];return(1&h-1>>>8)-1}function $(c,u){const h=new Uint8Array(32),t=new Uint8Array(32);return N(h,c),N(t,u),X(h,t)}function D(c){const u=new Uint8Array(32);return N(u,c),u[0]&1}function y(c,u){for(let h=0;h<16;h++)c[h]=u[2*h]+(u[2*h+1]<<8);c[15]&=32767}function L(c,u,h){for(let t=0;t<16;t++)c[t]=u[t]+h[t]}function b(c,u,h){for(let t=0;t<16;t++)c[t]=u[t]-h[t]}function e(c,u,h){let t,f,T=0,P=0,it=0,ot=0,ft=0,_t=0,wt=0,dt=0,ht=0,nt=0,rt=0,et=0,k=0,W=0,Z=0,Q=0,at=0,st=0,ct=0,ut=0,lt=0,xt=0,bt=0,vt=0,Ft=0,Ot=0,jt=0,zt=0,Yt=0,Jt=0,ne=0,Et=h[0],yt=h[1],gt=h[2],Lt=h[3],St=h[4],Ut=h[5],At=h[6],Ht=h[7],Mt=h[8],mt=h[9],Bt=h[10],pt=h[11],Tt=h[12],Kt=h[13],It=h[14],Nt=h[15];t=u[0],T+=t*Et,P+=t*yt,it+=t*gt,ot+=t*Lt,ft+=t*St,_t+=t*Ut,wt+=t*At,dt+=t*Ht,ht+=t*Mt,nt+=t*mt,rt+=t*Bt,et+=t*pt,k+=t*Tt,W+=t*Kt,Z+=t*It,Q+=t*Nt,t=u[1],P+=t*Et,it+=t*yt,ot+=t*gt,ft+=t*Lt,_t+=t*St,wt+=t*Ut,dt+=t*At,ht+=t*Ht,nt+=t*Mt,rt+=t*mt,et+=t*Bt,k+=t*pt,W+=t*Tt,Z+=t*Kt,Q+=t*It,at+=t*Nt,t=u[2],it+=t*Et,ot+=t*yt,ft+=t*gt,_t+=t*Lt,wt+=t*St,dt+=t*Ut,ht+=t*At,nt+=t*Ht,rt+=t*Mt,et+=t*mt,k+=t*Bt,W+=t*pt,Z+=t*Tt,Q+=t*Kt,at+=t*It,st+=t*Nt,t=u[3],ot+=t*Et,ft+=t*yt,_t+=t*gt,wt+=t*Lt,dt+=t*St,ht+=t*Ut,nt+=t*At,rt+=t*Ht,et+=t*Mt,k+=t*mt,W+=t*Bt,Z+=t*pt,Q+=t*Tt,at+=t*Kt,st+=t*It,ct+=t*Nt,t=u[4],ft+=t*Et,_t+=t*yt,wt+=t*gt,dt+=t*Lt,ht+=t*St,nt+=t*Ut,rt+=t*At,et+=t*Ht,k+=t*Mt,W+=t*mt,Z+=t*Bt,Q+=t*pt,at+=t*Tt,st+=t*Kt,ct+=t*It,ut+=t*Nt,t=u[5],_t+=t*Et,wt+=t*yt,dt+=t*gt,ht+=t*Lt,nt+=t*St,rt+=t*Ut,et+=t*At,k+=t*Ht,W+=t*Mt,Z+=t*mt,Q+=t*Bt,at+=t*pt,st+=t*Tt,ct+=t*Kt,ut+=t*It,lt+=t*Nt,t=u[6],wt+=t*Et,dt+=t*yt,ht+=t*gt,nt+=t*Lt,rt+=t*St,et+=t*Ut,k+=t*At,W+=t*Ht,Z+=t*Mt,Q+=t*mt,at+=t*Bt,st+=t*pt,ct+=t*Tt,ut+=t*Kt,lt+=t*It,xt+=t*Nt,t=u[7],dt+=t*Et,ht+=t*yt,nt+=t*gt,rt+=t*Lt,et+=t*St,k+=t*Ut,W+=t*At,Z+=t*Ht,Q+=t*Mt,at+=t*mt,st+=t*Bt,ct+=t*pt,ut+=t*Tt,lt+=t*Kt,xt+=t*It,bt+=t*Nt,t=u[8],ht+=t*Et,nt+=t*yt,rt+=t*gt,et+=t*Lt,k+=t*St,W+=t*Ut,Z+=t*At,Q+=t*Ht,at+=t*Mt,st+=t*mt,ct+=t*Bt,ut+=t*pt,lt+=t*Tt,xt+=t*Kt,bt+=t*It,vt+=t*Nt,t=u[9],nt+=t*Et,rt+=t*yt,et+=t*gt,k+=t*Lt,W+=t*St,Z+=t*Ut,Q+=t*At,at+=t*Ht,st+=t*Mt,ct+=t*mt,ut+=t*Bt,lt+=t*pt,xt+=t*Tt,bt+=t*Kt,vt+=t*It,Ft+=t*Nt,t=u[10],rt+=t*Et,et+=t*yt,k+=t*gt,W+=t*Lt,Z+=t*St,Q+=t*Ut,at+=t*At,st+=t*Ht,ct+=t*Mt,ut+=t*mt,lt+=t*Bt,xt+=t*pt,bt+=t*Tt,vt+=t*Kt,Ft+=t*It,Ot+=t*Nt,t=u[11],et+=t*Et,k+=t*yt,W+=t*gt,Z+=t*Lt,Q+=t*St,at+=t*Ut,st+=t*At,ct+=t*Ht,ut+=t*Mt,lt+=t*mt,xt+=t*Bt,bt+=t*pt,vt+=t*Tt,Ft+=t*Kt,Ot+=t*It,jt+=t*Nt,t=u[12],k+=t*Et,W+=t*yt,Z+=t*gt,Q+=t*Lt,at+=t*St,st+=t*Ut,ct+=t*At,ut+=t*Ht,lt+=t*Mt,xt+=t*mt,bt+=t*Bt,vt+=t*pt,Ft+=t*Tt,Ot+=t*Kt,jt+=t*It,zt+=t*Nt,t=u[13],W+=t*Et,Z+=t*yt,Q+=t*gt,at+=t*Lt,st+=t*St,ct+=t*Ut,ut+=t*At,lt+=t*Ht,xt+=t*Mt,bt+=t*mt,vt+=t*Bt,Ft+=t*pt,Ot+=t*Tt,jt+=t*Kt,zt+=t*It,Yt+=t*Nt,t=u[14],Z+=t*Et,Q+=t*yt,at+=t*gt,st+=t*Lt,ct+=t*St,ut+=t*Ut,lt+=t*At,xt+=t*Ht,bt+=t*Mt,vt+=t*mt,Ft+=t*Bt,Ot+=t*pt,jt+=t*Tt,zt+=t*Kt,Yt+=t*It,Jt+=t*Nt,t=u[15],Q+=t*Et,at+=t*yt,st+=t*gt,ct+=t*Lt,ut+=t*St,lt+=t*Ut,xt+=t*At,bt+=t*Ht,vt+=t*Mt,Ft+=t*mt,Ot+=t*Bt,jt+=t*pt,zt+=t*Tt,Yt+=t*Kt,Jt+=t*It,ne+=t*Nt,T+=38*at,P+=38*st,it+=38*ct,ot+=38*ut,ft+=38*lt,_t+=38*xt,wt+=38*bt,dt+=38*vt,ht+=38*Ft,nt+=38*Ot,rt+=38*jt,et+=38*zt,k+=38*Yt,W+=38*Jt,Z+=38*ne,f=1,t=T+f+65535,f=Math.floor(t/65536),T=t-f*65536,t=P+f+65535,f=Math.floor(t/65536),P=t-f*65536,t=it+f+65535,f=Math.floor(t/65536),it=t-f*65536,t=ot+f+65535,f=Math.floor(t/65536),ot=t-f*65536,t=ft+f+65535,f=Math.floor(t/65536),ft=t-f*65536,t=_t+f+65535,f=Math.floor(t/65536),_t=t-f*65536,t=wt+f+65535,f=Math.floor(t/65536),wt=t-f*65536,t=dt+f+65535,f=Math.floor(t/65536),dt=t-f*65536,t=ht+f+65535,f=Math.floor(t/65536),ht=t-f*65536,t=nt+f+65535,f=Math.floor(t/65536),nt=t-f*65536,t=rt+f+65535,f=Math.floor(t/65536),rt=t-f*65536,t=et+f+65535,f=Math.floor(t/65536),et=t-f*65536,t=k+f+65535,f=Math.floor(t/65536),k=t-f*65536,t=W+f+65535,f=Math.floor(t/65536),W=t-f*65536,t=Z+f+65535,f=Math.floor(t/65536),Z=t-f*65536,t=Q+f+65535,f=Math.floor(t/65536),Q=t-f*65536,T+=f-1+37*(f-1),f=1,t=T+f+65535,f=Math.floor(t/65536),T=t-f*65536,t=P+f+65535,f=Math.floor(t/65536),P=t-f*65536,t=it+f+65535,f=Math.floor(t/65536),it=t-f*65536,t=ot+f+65535,f=Math.floor(t/65536),ot=t-f*65536,t=ft+f+65535,f=Math.floor(t/65536),ft=t-f*65536,t=_t+f+65535,f=Math.floor(t/65536),_t=t-f*65536,t=wt+f+65535,f=Math.floor(t/65536),wt=t-f*65536,t=dt+f+65535,f=Math.floor(t/65536),dt=t-f*65536,t=ht+f+65535,f=Math.floor(t/65536),ht=t-f*65536,t=nt+f+65535,f=Math.floor(t/65536),nt=t-f*65536,t=rt+f+65535,f=Math.floor(t/65536),rt=t-f*65536,t=et+f+65535,f=Math.floor(t/65536),et=t-f*65536,t=k+f+65535,f=Math.floor(t/65536),k=t-f*65536,t=W+f+65535,f=Math.floor(t/65536),W=t-f*65536,t=Z+f+65535,f=Math.floor(t/65536),Z=t-f*65536,t=Q+f+65535,f=Math.floor(t/65536),Q=t-f*65536,T+=f-1+37*(f-1),c[0]=T,c[1]=P,c[2]=it,c[3]=ot,c[4]=ft,c[5]=_t,c[6]=wt,c[7]=dt,c[8]=ht,c[9]=nt,c[10]=rt,c[11]=et,c[12]=k,c[13]=W,c[14]=Z,c[15]=Q}function n(c,u){e(c,u,u)}function K(c,u){const h=w();let t;for(t=0;t<16;t++)h[t]=u[t];for(t=253;t>=0;t--)n(h,h),t!==2&&t!==4&&e(h,h,u);for(t=0;t<16;t++)c[t]=h[t]}function p(c,u){const h=w();let t;for(t=0;t<16;t++)h[t]=u[t];for(t=250;t>=0;t--)n(h,h),t!==1&&e(h,h,u);for(t=0;t<16;t++)c[t]=h[t]}function C(c,u){const h=w(),t=w(),f=w(),T=w(),P=w(),it=w(),ot=w(),ft=w(),_t=w();b(h,c[1],c[0]),b(_t,u[1],u[0]),e(h,h,_t),L(t,c[0],c[1]),L(_t,u[0],u[1]),e(t,t,_t),e(f,c[3],u[3]),e(f,f,x),e(T,c[2],u[2]),L(T,T,T),b(P,t,h),b(it,T,f),L(ot,T,f),L(ft,t,h),e(c[0],P,it),e(c[1],ft,ot),e(c[2],ot,it),e(c[3],P,ft)}function R(c,u,h){for(let t=0;t<4;t++)F(c[t],u[t],h)}function O(c,u){const h=w(),t=w(),f=w();K(f,u[2]),e(h,u[0],f),e(t,u[1],f),N(c,t),c[31]^=D(h)<<7}function l(c,u,h){E(c[0],q),E(c[1],s),E(c[2],s),E(c[3],q);for(let t=255;t>=0;--t){const f=h[t/8|0]>>(t&7)&1;R(c,u,f),C(u,c),C(c,c),R(c,u,f)}}function _(c,u){const h=[w(),w(),w(),w()];E(h[0],d),E(h[1],I),E(h[2],s),e(h[3],d,I),l(c,h,u)}function G(c){if(c.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const u=(0,a.hash)(c);u[0]&=248,u[31]&=127,u[31]|=64;const h=new Uint8Array(32),t=[w(),w(),w(),w()];_(t,u),O(h,t);const f=new Uint8Array(64);return f.set(c),f.set(h,32),{publicKey:h,secretKey:f}}r.generateKeyPairFromSeed=G;function A(c){const u=(0,i.randomBytes)(32,c),h=G(u);return(0,v.wipe)(u),h}r.generateKeyPair=A;function g(c){if(c.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(c.subarray(32))}r.extractPublicKeyFromSecretKey=g;const S=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function U(c,u){let h,t,f,T;for(t=63;t>=32;--t){for(h=0,f=t-32,T=t-12;f<T;++f)u[f]+=h-16*u[t]*S[f-(t-32)],h=Math.floor((u[f]+128)/256),u[f]-=h*256;u[f]+=h,u[t]=0}for(h=0,f=0;f<32;f++)u[f]+=h-(u[31]>>4)*S[f],h=u[f]>>8,u[f]&=255;for(f=0;f<32;f++)u[f]-=h*S[f];for(t=0;t<32;t++)u[t+1]+=u[t]>>8,c[t]=u[t]&255}function M(c){const u=new Float64Array(64);for(let h=0;h<64;h++)u[h]=c[h];for(let h=0;h<64;h++)c[h]=0;U(c,u)}function V(c,u){const h=new Float64Array(64),t=[w(),w(),w(),w()],f=(0,a.hash)(c.subarray(0,32));f[0]&=248,f[31]&=127,f[31]|=64;const T=new Uint8Array(64);T.set(f.subarray(32),32);const P=new a.SHA512;P.update(T.subarray(32)),P.update(u);const it=P.digest();P.clean(),M(it),_(t,it),O(T,t),P.reset(),P.update(T.subarray(0,32)),P.update(c.subarray(32)),P.update(u);const ot=P.digest();M(ot);for(let ft=0;ft<32;ft++)h[ft]=it[ft];for(let ft=0;ft<32;ft++)for(let _t=0;_t<32;_t++)h[ft+_t]+=ot[ft]*f[_t];return U(T.subarray(32),h),T}r.sign=V;function m(c,u){const h=w(),t=w(),f=w(),T=w(),P=w(),it=w(),ot=w();return E(c[2],s),y(c[1],u),n(f,c[1]),e(T,f,o),b(f,f,c[2]),L(T,c[2],T),n(P,T),n(it,P),e(ot,it,P),e(h,ot,f),e(h,h,T),p(h,h),e(h,h,f),e(h,h,T),e(h,h,T),e(c[0],h,T),n(t,c[0]),e(t,t,T),$(t,f)&&e(c[0],c[0],H),n(t,c[0]),e(t,t,T),$(t,f)?-1:(D(c[0])===u[31]>>7&&b(c[0],q,c[0]),e(c[3],c[0],c[1]),0)}function z(c,u,h){const t=new Uint8Array(32),f=[w(),w(),w(),w()],T=[w(),w(),w(),w()];if(h.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(m(T,c))return!1;const P=new a.SHA512;P.update(h.subarray(0,32)),P.update(c),P.update(u);const it=P.digest();return M(it),l(f,T,it),_(T,h.subarray(32)),C(f,T),O(t,f),!X(h,t)}r.verify=z;function J(c){let u=[w(),w(),w(),w()];if(m(u,c))throw new Error("Ed25519: invalid public key");let h=w(),t=w(),f=u[1];L(h,s,f),b(t,s,f),K(t,t),e(h,h,t);let T=new Uint8Array(32);return N(T,h),T}r.convertPublicKeyToX25519=J;function tt(c){const u=(0,a.hash)(c.subarray(0,32));u[0]&=248,u[31]&=127,u[31]|=64;const h=new Uint8Array(u.subarray(0,32));return(0,v.wipe)(u),h}r.convertSecretKeyToX25519=tt})(xr);export{vr as H,Le as c,xr as e,fe as r,_r as s,lr as x};
